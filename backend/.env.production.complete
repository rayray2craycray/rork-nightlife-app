# ===================================
# RORK NIGHTLIFE APP - PRODUCTION
# GROWTH FEATURES ENABLED
# ===================================
# Copy this file to .env.production and fill in your actual production values
# NEVER commit .env.production to version control!
# Last Updated: February 12, 2026 - Growth Features Complete

# ===================================
# SERVER CONFIGURATION
# ===================================
PORT=5000
NODE_ENV=production
APP_ENV=production

# Production URLs (update with your actual domains)
DOMAIN=https://api.rork.app
APP_URL=https://api.rork.app
FRONTEND_URL=https://rork.app

# ===================================
# DATABASE - MongoDB Atlas
# ===================================
# Production MongoDB Atlas connection string
# Format: mongodb+srv://<username>:<password>@<cluster>.mongodb.net/<database>?retryWrites=true&w=majority
MONGODB_URI=mongodb+srv://production-user:REPLACE_WITH_STRONG_PASSWORD@cluster0.xxxxx.mongodb.net/rork-nightlife-prod?retryWrites=true&w=majority

# Optional: Separate database for testing in production environment
MONGODB_TEST_URI=mongodb+srv://production-user:REPLACE_WITH_STRONG_PASSWORD@cluster0.xxxxx.mongodb.net/rork-nightlife-test?retryWrites=true&w=majority

# ===================================
# AUTHENTICATION & SECURITY
# ===================================
# JWT Secret - MUST be a strong, random string (min 32 characters)
# Generate with: openssl rand -base64 32
JWT_SECRET=REPLACE_WITH_STRONG_RANDOM_SECRET_MIN_32_CHARS

# JWT Expiration times
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# API Key for client authentication (optional)
API_KEY=REPLACE_WITH_STRONG_API_KEY

# Bcrypt salt rounds (12 recommended for production)
BCRYPT_SALT_ROUNDS=12

# Session secret for cookie signing
SESSION_SECRET=REPLACE_WITH_STRONG_SESSION_SECRET

# ===================================
# CLOUDINARY - Media Storage
# ===================================
# Get these from: https://cloudinary.com/console
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret
CLOUDINARY_UPLOAD_PRESET=rork-unsigned-preset
CLOUDINARY_FOLDER=rork-app

# ===================================
# GOOGLE MAPS API
# ===================================
# Get from: https://console.cloud.google.com/
GOOGLE_MAPS_API_KEY=your-google-maps-api-key
GOOGLE_MAPS_IOS_API_KEY=your-ios-api-key
GOOGLE_MAPS_ANDROID_API_KEY=your-android-api-key

# ===================================
# INSTAGRAM API
# ===================================
# Get these from: https://developers.facebook.com/
INSTAGRAM_CLIENT_ID=your_instagram_client_id
INSTAGRAM_CLIENT_SECRET=your_instagram_client_secret
INSTAGRAM_REDIRECT_URI=https://rork.app/instagram-callback
INSTAGRAM_GRAPH_API_URL=https://graph.instagram.com
INSTAGRAM_API_URL=https://api.instagram.com

# ===================================
# POS INTEGRATION - Toast
# ===================================
# Toast POS API credentials
TOAST_CLIENT_ID=your-toast-client-id
TOAST_CLIENT_SECRET=your-toast-client-secret
TOAST_MANAGEMENT_API_URL=https://api.toasttab.com
TOAST_WEBHOOK_SECRET=your-toast-webhook-secret

# Encryption for POS data
POS_ENCRYPTION_KEY=REPLACE_WITH_32_BYTE_HEX_KEY

# ===================================
# POS INTEGRATION - Square
# ===================================
# Square API credentials
SQUARE_APPLICATION_ID=your-square-app-id
SQUARE_ACCESS_TOKEN=your-square-access-token
SQUARE_LOCATION_ID=your-square-location-id
SQUARE_WEBHOOK_SIGNATURE_KEY=your-square-webhook-key

# ===================================
# RATE LIMITING
# ===================================
# Window time in milliseconds (15 minutes = 900000ms)
RATE_LIMIT_WINDOW_MS=900000

# Max requests per window
RATE_LIMIT_MAX_REQUESTS=100

# Upload rate limiting (stricter for file uploads)
UPLOAD_RATE_LIMIT_WINDOW_MS=900000
UPLOAD_RATE_LIMIT_MAX_REQUESTS=10

# Auth rate limiting (stricter for login/signup)
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# ===================================
# CORS - Cross-Origin Resource Sharing
# ===================================
# Comma-separated list of allowed origins
# Production should ONLY include your production domains
ALLOWED_ORIGINS=https://rork.app,https://www.rork.app,https://admin.rork.app

# Allow credentials (cookies, authorization headers)
CORS_CREDENTIALS=true

# ===================================
# LOGGING
# ===================================
# Log levels: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=info

# Log to file in production
LOG_TO_FILE=true
LOG_FILE_PATH=./logs/production.log

# ===================================
# EMAIL - SendGrid/SMTP
# ===================================
# SMTP Configuration for sending emails
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=apikey
SMTP_PASS=your-sendgrid-api-key
EMAIL_FROM=noreply@rork.app
EMAIL_FROM_NAME=Rork Nightlife

# ===================================
# PAYMENT PROCESSING - Stripe
# ===================================
# Stripe Configuration
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_live_your_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# ===================================
# MONITORING & ERROR TRACKING
# ===================================
# Sentry for error tracking - REQUIRED for production
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Google Analytics
GA_TRACKING_ID=UA-XXXXXXXXX-X

# ===================================
# CACHING - Redis (Recommended)
# ===================================
# Redis URL for caching and session storage
REDIS_URL=redis://username:password@redis-host:6379

# Cache TTL in seconds
CACHE_TTL=3600

# Session store
SESSION_STORE=redis

# ===================================
# SOCKET.IO - Real-time Chat
# ===================================
# Socket.io Redis adapter for horizontal scaling
SOCKET_REDIS_HOST=redis-host
SOCKET_REDIS_PORT=6379
SOCKET_REDIS_PASSWORD=redis-password

# ===================================
# FILE UPLOAD LIMITS
# ===================================
# Max file size in bytes (50MB = 52428800)
MAX_FILE_SIZE=52428800

# Max video duration in seconds (15s for highlights)
MAX_VIDEO_DURATION=15

# Image quality (0.0 - 1.0)
IMAGE_QUALITY=0.85

# ===================================
# GROWTH FEATURES CONFIGURATION
# ===================================

# Referral System
REFERRAL_REWARD_AMOUNT=10
REFERRAL_REWARD_TYPE=DISCOUNT
REFERRAL_CODE_LENGTH=6

# Group Purchases
GROUP_PURCHASE_EXPIRY_HOURS=24
GROUP_PURCHASE_MIN_PARTICIPANTS=2
GROUP_PURCHASE_MAX_PARTICIPANTS=20

# Dynamic Pricing
DYNAMIC_PRICING_ENABLED=true
DYNAMIC_PRICING_MIN_DISCOUNT=10
DYNAMIC_PRICING_MAX_DISCOUNT=50
DYNAMIC_PRICING_UPDATE_INTERVAL_MINUTES=15

# Streaks & Retention
STREAK_EXPIRY_DAYS=2
STREAK_MILESTONE_REWARDS=7,14,30,60,90

# Challenges
CHALLENGE_DURATION_DAYS=30
CHALLENGE_MIN_PARTICIPANTS=1

# ===================================
# FEATURE FLAGS
# ===================================
# Enable/disable features
ENABLE_INSTAGRAM_SYNC=true
ENABLE_PAYMENT_PROCESSING=true
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_PUSH_NOTIFICATIONS=true
ENABLE_GROUP_PURCHASES=true
ENABLE_DYNAMIC_PRICING=true
ENABLE_REFERRAL_SYSTEM=true
ENABLE_CHALLENGES=true
ENABLE_STREAKS=true
ENABLE_GUEST_LIST=true
ENABLE_QR_CHECKIN=true
ENABLE_POS_INTEGRATION=true
ENABLE_CONTENT_MODERATION=true

# ===================================
# MAINTENANCE MODE
# ===================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We're currently performing maintenance. Please check back soon.

# ===================================
# PERFORMANCE
# ===================================
# Request timeout in milliseconds (30 seconds)
REQUEST_TIMEOUT=30000

# Max concurrent uploads
MAX_CONCURRENT_UPLOADS=5

# Database connection pool size
DB_POOL_SIZE=10

# Body parser limits
JSON_LIMIT=1mb
URLENCODED_LIMIT=1mb

# ===================================
# SECURITY HEADERS
# ===================================
# Content Security Policy
CSP_DIRECTIVES=default-src 'self'; img-src 'self' data: https:; media-src 'self' https:; script-src 'self'

# HTTP Strict Transport Security (HSTS)
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# ===================================
# API VERSIONING
# ===================================
API_VERSION=v1

# ===================================
# BACKUP & DISASTER RECOVERY
# ===================================
# Automated backup schedule (cron format: At 2:00 AM daily)
BACKUP_SCHEDULE=0 2 * * *

# Backup retention days
BACKUP_RETENTION_DAYS=30

# Backup storage location
BACKUP_STORAGE_PATH=/backups
BACKUP_S3_BUCKET=rork-backups

# ===================================
# WEBHOOK CONFIGURATION
# ===================================
# Webhook secret for external services
WEBHOOK_SECRET=REPLACE_WITH_STRONG_WEBHOOK_SECRET

# ===================================
# EAS (Expo Application Services)
# ===================================
# EAS Project ID for OTA updates
EAS_PROJECT_ID=your-eas-project-id

# ===================================
# PRODUCTION DEPLOYMENT INFO
# ===================================
# Deployment platform (aws, heroku, digitalocean, etc.)
DEPLOYMENT_PLATFORM=aws

# Server region
SERVER_REGION=us-east-1

# Build version
BUILD_VERSION=1.0.0

# ===================================
# NOTES FOR PRODUCTION DEPLOYMENT
# ===================================
# 1. Replace ALL placeholder values before deploying
# 2. Use strong, random passwords and secrets (min 32 chars)
# 3. Keep this file secure and never commit to version control
# 4. Update ALLOWED_ORIGINS to only include your production domains
# 5. Enable HTTPS/TLS for all production traffic
# 6. Configure Sentry DSN for error tracking
# 7. Set up Redis for caching and sessions
# 8. Configure MongoDB Atlas with proper security
# 9. Set up automated backups (daily recommended)
# 10. Test disaster recovery procedures
# 11. Monitor logs and set up alerts
# 12. Regularly rotate secrets and passwords (quarterly)
# 13. Review and update feature flags as needed
# 14. Configure POS integrations if using Toast/Square
# 15. Set up proper SMTP for email notifications

# ===================================
# SECURITY CHECKLIST
# ===================================
# [ ] JWT_SECRET is random and secure (32+ chars)
# [ ] MONGODB_URI uses strong password
# [ ] ALLOWED_ORIGINS only includes production domains
# [ ] SENTRY_DSN configured for error tracking
# [ ] Redis password is strong and secure
# [ ] SMTP credentials are valid
# [ ] Stripe keys are production keys
# [ ] All API keys are production keys
# [ ] CORS credentials properly configured
# [ ] Rate limiting configured appropriately
# [ ] HTTPS/TLS enabled on all endpoints
# [ ] Database backups automated
# [ ] Monitoring and alerting configured
# [ ] Log files properly secured
# [ ] File upload limits configured
# [ ] Session secrets are strong
# [ ] POS encryption key is 32-byte hex

# ===================================
# GROWTH FEATURES ENDPOINTS
# ===================================
# Ensure these routes are accessible:
# /api/growth - Group purchases, referrals
# /api/events - Events, tickets, guest lists
# /api/pricing - Dynamic pricing
# /api/retention - Streaks, memories
# /api/social - Crews, challenges
# /api/content - Content feed
# /api/moderation - Content moderation
# /api/chat - Real-time chat
